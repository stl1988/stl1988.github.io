<html>
<head>
	<!-- Script sources -->
<script src="time.js"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>

<script src="http.js"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.2.2/pdfmake.min.js" integrity="sha512-Yf733gmgLgGUo+VfWq4r5HAEaxftvuTes86bKvwTpqOY3oH0hHKtX/9FfKYUcpaxeBJxeXvcN4EY3J6fnmc9cA==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.2.2/vfs_fonts.js" integrity="sha512-cktKDgjEiIkPVHYbn8bh/FEyYxmt4JDJJjOCu5/FQAkW4bc911XtKYValiyzBiJigjVEvrIAyQFEbRJZyDA1wQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
	
<!--
<script src="//cdn.jsdelivr.net/npm/eruda"></script>
<script>eruda.init();</script>
-->
<style>
	img {
    max-width: 100%;
    height: auto;
    width: auto\9; /* ie8 */
}
	</style>
	
	
</head>


<body>
  <h1>API test for fnReport and fortniteapi.io</h1><br>
  
	<script type="text/javascript" charset="utf-8">
	const urlParams = new URLSearchParams(window.location.search);
		const pvar1 = urlParams.get('user');
    const pvar2 = urlParams.get('lang');
    const pvar3 = urlParams.get('key');
		alert("user "+pvar1+", language "+pvar2+", API-key "+pvar3);
		
		
		var apikey = pvar3;
		
		// Endpoints ================================================================================================================
		var datum=date.getTime()/1000;
		var fnbr = JSON.parse(httpGet2("https://fortniteapi.io/v1/news?lang="+pvar2+"&type=br","Authorization",apikey));
		var fnstw = JSON.parse(httpGet2("https://fortniteapi.io/v1/news?lang="+pvar2+"&type=stw","Authorization",apikey));
		var fncreative = JSON.parse(httpGet2("https://fortniteapi.io/v1/news?lang="+pvar2+"&type=creative","Authorization",apikey));
		var fnuser = JSON.parse(httpGet2("https://fortniteapi.io/v1/lookup?username="+pvar1,"Authorization",apikey));
		if(fnuser.result=true) {
		var fnmatches= JSON.parse(httpGet2("https://fortniteapi.io/v1/matches?account="+fnuser.account_id,"Authorization",apikey));
		var fnstats= JSON.parse(httpGet2("https://fortniteapi.io/v1/stats?account="+fnuser.account_id,"Authorization",apikey));
                }
		var fnshop= JSON.parse(httpGet2("https://fortniteapi.io/v2/shop?lang="+pvar2,"Authorization",apikey));
		var fnchallenges = JSON.parse(httpGet2("https://fortniteapi.io/v2/challenges?season=current&lang"+pvar2,"Authorization",apikey));
    
    
      
      
    
		
		// Map ===============================================================================================================================
		document.write('<h2>Current map</h2><img src="https://media.fortniteapi.io/images/map.png?showPOI=true" alt="map image"><br>');
		document.write('<div style="break-after:page"></div>');
		// Shop ==============================================================================================================================
		document.write('<h2>Shop</h2>Updated: '+fnshop.lastUpdate.date+'<br>');
		for(i=0;i<fnshop.shop.length;i++) {
			document.write("<h3>"+fnshop.shop[i].displayName+"</h3>");
			document.write("displayDescription: "+fnshop.shop[i].displayDescription+"<br>");
			document.write("first released: "+fnshop.shop[i].firstReleaseDate+", previously released: "+fnshop.shop[i].previousReleaseDate+"<br>");
			document.write("regular price: "+fnshop.shop[i].price.regularPrice+", final price: "+fnshop.shop[i].price.finalPrice+"<br>");
			
			document.write("displayAssets: <br>");
			for(j=0;j<fnshop.shop[i].displayAssets.length;j++) {
				document.write('<img src="'+fnshop.shop[i].displayAssets[j].full_background+'" width=300 alt="asset image">');
			}
			document.write("<br><br>granted: <br>");
			for(k=0;k<fnshop.shop[i].granted.length;k++) {
				document.write("<h4>"+fnshop.shop[i].granted[k].name+"</h4>");
				document.write("description: "+fnshop.shop[i].granted[k].description+"<br>");
				document.write("series: "+fnshop.shop[i].granted[k].series+"<br>");
				document.write('<img src="'+fnshop.shop[i].granted[k].images.full_background+'" width=200 alt="granted image"><br>');
			}
			
		}
    
    
    
  </script>
  </body>
</html>
